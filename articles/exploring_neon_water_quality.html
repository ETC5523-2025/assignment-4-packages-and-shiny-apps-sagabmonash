<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploring NEON Water Quality • neonWaterQuality</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploring NEON Water Quality">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neonWaterQuality</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://sagabari.shinyapps.io/neon-water-explorer/" target="_blank">Live Shiny App 🚀</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ETC5523-2025/assignment-4-packages-and-shiny-apps-sagabmonash/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Exploring NEON Water Quality</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ETC5523-2025/assignment-4-packages-and-shiny-apps-sagabmonash/blob/main/vignettes/exploring_neon_water_quality.Rmd" class="external-link"><code>vignettes/exploring_neon_water_quality.Rmd</code></a></small>
      <div class="d-none name"><code>exploring_neon_water_quality.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explores the <code>neon_water_quality</code> dataset
included in the <code>neonWaterQuality</code> package. This dataset
contains high-frequency (15-minute intervals) water quality measurements
from three US sites (Arikaree River, Caribou Creek, Lewis Run) managed
by the National Ecological Observatory Network (NEON) for the years
2018-2019.</p>
<p>The data processing follows the methodology described in the
paper:</p>
<blockquote>
<p>Kermorvant C, Liquet B, Litt G, Mengersen K, Peterson EE, Hyndman RJ,
et al. (2023) Understanding links between water-quality variables and
nitrate concentration in freshwater streams using high frequency sensor
data. PLoS ONE 18(6): e0287640. <a href="https://doi.org/10.1371/journal.pone.0287640" class="external-link">https://doi.org/10.1371/journal.pone.0287640</a></p>
</blockquote>
<p>We will demonstrate how to load the data and perform some basic
exploratory analysis.</p>
</div>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the specific dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"neon_water_quality"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">neon_water_quality</span><span class="op">)</span></span>
<span><span class="co">#&gt;   siteID       siteName            datetime nitrate temperature</span></span>
<span><span class="co">#&gt; 1   ARIK Arikaree River 2018-11-16 18:15:00     1.5    5.762667</span></span>
<span><span class="co">#&gt; 2   ARIK Arikaree River 2018-11-16 18:30:00     1.5    5.955667</span></span>
<span><span class="co">#&gt; 3   ARIK Arikaree River 2018-11-16 18:45:00     1.5    6.173333</span></span>
<span><span class="co">#&gt; 4   ARIK Arikaree River 2018-11-16 19:00:00     1.5    6.438333</span></span>
<span><span class="co">#&gt; 5   ARIK Arikaree River 2018-11-16 19:15:00     1.5    6.659333</span></span>
<span><span class="co">#&gt; 6   ARIK Arikaree River 2018-11-16 19:30:00     1.5    6.860333</span></span>
<span><span class="co">#&gt;   dissolved_oxygen specific_conductance turbidity log_turbidity elevation</span></span>
<span><span class="co">#&gt; 1         9.030000             600.1675 0.5162500     0.4162402   1179.47</span></span>
<span><span class="co">#&gt; 2         9.019333             600.0707 0.5200000     0.4187103   1179.47</span></span>
<span><span class="co">#&gt; 3         9.004000             599.5880 0.5166667     0.4165149   1179.47</span></span>
<span><span class="co">#&gt; 4         8.984000             599.1787 0.4960000     0.4027949   1179.47</span></span>
<span><span class="co">#&gt; 5         8.966000             598.8213 0.4920000     0.4001175   1179.47</span></span>
<span><span class="co">#&gt; 6         8.941333             598.4727 0.4893333     0.3983286   1179.47</span></span>
<span></span>
<span><span class="co"># Show the structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">neon_water_quality</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'data.table' and 'data.frame':   43215 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ siteID              : chr  "ARIK" "ARIK" "ARIK" "ARIK" ...</span></span>
<span><span class="co">#&gt;  $ siteName            : chr  "Arikaree River" "Arikaree River" "Arikaree River" "Arikaree River" ...</span></span>
<span><span class="co">#&gt;  $ datetime            : POSIXct, format: "2018-11-16 18:15:00" "2018-11-16 18:30:00" ...</span></span>
<span><span class="co">#&gt;  $ nitrate             : num  1.5 1.5 1.5 1.5 1.5 1.5 1.6 1.6 1.6 1.6 ...</span></span>
<span><span class="co">#&gt;  $ temperature         : num  5.76 5.96 6.17 6.44 6.66 ...</span></span>
<span><span class="co">#&gt;  $ dissolved_oxygen    : num  9.03 9.02 9 8.98 8.97 ...</span></span>
<span><span class="co">#&gt;  $ specific_conductance: num  600 600 600 599 599 ...</span></span>
<span><span class="co">#&gt;  $ turbidity           : num  0.516 0.52 0.517 0.496 0.492 ...</span></span>
<span><span class="co">#&gt;  $ log_turbidity       : num  0.416 0.419 0.417 0.403 0.4 ...</span></span>
<span><span class="co">#&gt;  $ elevation           : num  1179 1179 1179 1179 1179 ...</span></span>
<span><span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis-eda"></a>
</h2>
<div class="section level3">
<h3 id="summarize-the-data">Summarize the Data<a class="anchor" aria-label="anchor" href="#summarize-the-data"></a>
</h3>
<p>This chunk uses <code>dplyr</code> to calculate summary statistics
for key variables, grouped by site.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate summary statistics for key variables by site</span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="va">neon_water_quality</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">siteName</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nitrate</span>, <span class="va">temperature</span>, <span class="va">dissolved_oxygen</span>, <span class="va">specific_conductance</span>, <span class="va">turbidity</span>, <span class="va">elevation</span><span class="op">)</span>, </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>             min <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>             median <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>             mean <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>             max <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>           <span class="op">)</span>,</span>
<span>           .names <span class="op">=</span> <span class="st">"{.col}_{.fn}"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the summary table nicely</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_stats</span>, caption <span class="op">=</span> <span class="st">"Summary statistics for key water quality variables by site."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics for key water quality variables by
site.</caption>
<colgroup>
<col width="3%">
<col width="2%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="3%">
<col width="4%">
<col width="3%">
<col width="3%">
<col width="4%">
<col width="5%">
<col width="4%">
<col width="4%">
<col width="5%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="left">siteName</th>
<th align="right">nitrate_min</th>
<th align="right">nitrate_median</th>
<th align="right">nitrate_mean</th>
<th align="right">nitrate_max</th>
<th align="right">temperature_min</th>
<th align="right">temperature_median</th>
<th align="right">temperature_mean</th>
<th align="right">temperature_max</th>
<th align="right">dissolved_oxygen_min</th>
<th align="right">dissolved_oxygen_median</th>
<th align="right">dissolved_oxygen_mean</th>
<th align="right">dissolved_oxygen_max</th>
<th align="right">specific_conductance_min</th>
<th align="right">specific_conductance_median</th>
<th align="right">specific_conductance_mean</th>
<th align="right">specific_conductance_max</th>
<th align="right">turbidity_min</th>
<th align="right">turbidity_median</th>
<th align="right">turbidity_mean</th>
<th align="right">turbidity_max</th>
<th align="right">elevation_min</th>
<th align="right">elevation_median</th>
<th align="right">elevation_mean</th>
<th align="right">elevation_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Arikaree River</td>
<td align="right">0.1</td>
<td align="right">4.7</td>
<td align="right">4.641519</td>
<td align="right">17.7</td>
<td align="right">-0.6730000</td>
<td align="right">7.41600</td>
<td align="right">11.698776</td>
<td align="right">31.751000</td>
<td align="right">0.694</td>
<td align="right">6.772667</td>
<td align="right">6.138543</td>
<td align="right">11.99000</td>
<td align="right">373.1093</td>
<td align="right">542.6120</td>
<td align="right">548.37919</td>
<td align="right">629.8873</td>
<td align="right">0</td>
<td align="right">2.192667</td>
<td align="right">67.827515</td>
<td align="right">3989.920</td>
<td align="right">1179.3600</td>
<td align="right">1179.61</td>
<td align="right">1179.6156</td>
<td align="right">1179.83</td>
</tr>
<tr class="even">
<td align="left">Caribou Creek</td>
<td align="right">18.5</td>
<td align="right">28.0</td>
<td align="right">27.757162</td>
<td align="right">36.6</td>
<td align="right">-0.0593333</td>
<td align="right">3.98450</td>
<td align="right">4.020007</td>
<td align="right">8.755667</td>
<td align="right">10.200</td>
<td align="right">12.198667</td>
<td align="right">12.061401</td>
<td align="right">14.39667</td>
<td align="right">25.1780</td>
<td align="right">80.1770</td>
<td align="right">77.77621</td>
<td align="right">106.8787</td>
<td align="right">0</td>
<td align="right">1.606667</td>
<td align="right">3.329309</td>
<td align="right">300.590</td>
<td align="right">225.5533</td>
<td align="right">225.65</td>
<td align="right">225.6689</td>
<td align="right">226.43</td>
</tr>
<tr class="odd">
<td align="left">Lewis Run</td>
<td align="right">76.7</td>
<td align="right">200.0</td>
<td align="right">205.797985</td>
<td align="right">268.8</td>
<td align="right">1.5863333</td>
<td align="right">15.74417</td>
<td align="right">14.196661</td>
<td align="right">21.622333</td>
<td align="right">7.424</td>
<td align="right">9.155333</td>
<td align="right">9.528647</td>
<td align="right">12.84600</td>
<td align="right">269.5413</td>
<td align="right">573.8567</td>
<td align="right">564.04677</td>
<td align="right">651.3267</td>
<td align="right">0</td>
<td align="right">14.615000</td>
<td align="right">30.592213</td>
<td align="right">1191.291</td>
<td align="right">124.9200</td>
<td align="right">125.08</td>
<td align="right">125.0759</td>
<td align="right">125.34</td>
</tr>
</tbody>
</table>
<p>The table above shows the minimum, median, mean, and maximum values
for the main water quality variables at the three NEON sites. Notice how
the typical ranges are different. For example, Lewis Run has a much
higher median nitrate concentration than Arikaree River and Caribou
Creek, while Caribou Creek has a much lower specific conductance. These
differences show how different the weather and environment are at each
site.</p>
</div>
<div class="section level3">
<h3 id="visualize-distributions">Visualize Distributions<a class="anchor" aria-label="anchor" href="#visualize-distributions"></a>
</h3>
<p>This chunk creates histograms to show the distribution of nitrate
concentrations at each site, faceted for easy comparison.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">neon_water_quality</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">nitrate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"skyblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">siteName</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># free scales for better visibility</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Nitrate Concentrations"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Nitrate (µmol/L)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency (Count of 15-min intervals)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="exploring_neon_water_quality_files/figure-html/visualize-distributions-1.png" alt="Distribution of nitrate concentrations at each site." width="700"><p class="caption">
Distribution of nitrate concentrations at each site.
</p>
</div>
<p>These histograms show how the nitrate levels are spread out at each
site. The distributions are very different. Lewis Run has a distribution
that is centred around much higher concentrations, while Arikaree and
Caribou Creek have distributions that are skewed towards lower values.
The scales = “free” argument is used because the ranges are so
different.</p>
</div>
<div class="section level3">
<h3 id="visualize-time-series">Visualize Time Series<a class="anchor" aria-label="anchor" href="#visualize-time-series"></a>
</h3>
<p>This chunk plots nitrate concentration over time for all three
sites.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">neon_water_quality</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">nitrate</span>, color <span class="op">=</span> <span class="va">siteName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">siteName</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Stacked vertically, free y-axis</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Nitrate Concentration Over Time"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Nitrate (µmol/L)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="exploring_neon_water_quality_files/figure-html/visualize-timeseries-1.png" alt="Nitrate concentration over the study period (2018-2019)." width="700"><p class="caption">
Nitrate concentration over the study period (2018-2019).
</p>
</div>
<p>This graph shows how the nitrate levels changed over time at each
site. We can see different patterns and changes. Lewis Run has higher
overall nitrate levels and may have noticeable seasonal changes than the
patterns at Caribou Creek, which are relatively stable but noisy, or the
patterns at Arikaree River, which are sometimes irregular.</p>
</div>
<div class="section level3">
<h3 id="explore-relationships">Explore Relationships<a class="anchor" aria-label="anchor" href="#explore-relationships"></a>
</h3>
<p>These chunks recreate scatter plots similar to those implicitly
discussed in the paper when building the GAM models.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">neon_water_quality</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">specific_conductance</span>, y <span class="op">=</span> <span class="va">nitrate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">siteName</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Add color, reduce alpha/size</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">siteName</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Free scales are essential</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Nitrate vs. Specific Conductance"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Specific Conductance (µS/cm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Nitrate (µmol/L)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="exploring_neon_water_quality_files/figure-html/explore-nitrate-vs-conductance-1.png" alt="Relationship between nitrate and specific conductance." width="700"><p class="caption">
Relationship between nitrate and specific conductance.
</p>
</div>
<p><strong>Nitrate vs. Specific Conductance</strong></p>
<p>This scatter plot explores the relationship between nitrate and
specific conductance. The paper says that this relationship is very
different at different sites. There seems to be a complicated,
non-linear relationship at Caribou Creek, while the patterns at Arikaree
River and Lewis Run are different, especially at lower conductance
values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">neon_water_quality</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">log_turbidity</span>, y <span class="op">=</span> <span class="va">nitrate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">siteName</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">siteName</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Nitrate vs. Log-Turbidity"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Log(Turbidity + 1)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Nitrate (µmol/L)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="exploring_neon_water_quality_files/figure-html/explore-nitrate-vs-logturbidity-1.png" alt="Relationship between nitrate and log-transformed turbidity." width="700"><p class="caption">
Relationship between nitrate and log-transformed turbidity.
</p>
</div>
<p><strong>Nitrate vs. Log-Turbidity</strong></p>
<p>We look at the relationship between nitrate concentration and
turbidity that has been changed into logs. The relationship seems weak
and changes from site to site. It could be negative at Caribou and
Arikaree, and it could be more complicated at Lewis Run. This is in line
with the paper’s GAM analysis, which found wide confidence
intervals.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The “neon_water_quality” dataset is a great way to learn about how
water quality changes in different environments. Nitrate levels and how
they relate to other factors, such as temperature and specific
conductance, differ a lot from one site to the next.</p>
<p>To explore more interactively, run <code><a href="../reference/launch_app.html">launch_app()</a></code> to open
the Shiny app that comes with this package.</p>
</div>
<div class="section level2">
<h2 id="package-structure">Package Structure<a class="anchor" aria-label="anchor" href="#package-structure"></a>
</h2>
<p>The <code>neonWaterQuality</code> package follows the standard R
package structure. Here’s an overview of the key directories and their
purpose:</p>
<pre class="text"><code>neonWaterQuality/
├── R/
│   ├── data.R         # Documentation for the dataset
│   └── launch_app.R   # Function to launch the Shiny app
├── data/
│   └── neon_water_quality.rda # The processed water quality dataset
├── data-raw/
│   └── data_prep.R    # Script to download and process raw NEON data
├── inst/
│   └── app/
│       └── app.R       # The Shiny application code
├── man/                # Automatically generated documentation files
│   └── neon_water_quality.Rd # Output of automatically generated by the devtools
│   └── launch_app.Rd         # Output of automatically generated by the devtools
├── vignettes/
│   └── exploring_neon_water_quality.Rmd # Vignette file
│   └── .gitignore     # files to ignore in Git 
├── DESCRIPTION        # Package metadata (name, author, dependencies)
├── LICENSE            # Package license (MIT)
├── NAMESPACE          # Automatically generated package namespace
└── README.Rmd         # README file for github
└── README.md          # Overview and installation instructions (from README.Rmd)</code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bagas Ari Wibawanto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
